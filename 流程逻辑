3.7.1 用户登录流程图

开始
  ↓
[用户输入用户名密码]
  ↓
[前端加密传输]
  ↓
[AuthModule接收请求]
  ↓
[验证用户名是否存在] → 不存在 → [返回"用户不存在"] → 结束
  ↓ 存在
[验证密码是否匹配] → 不匹配 → [记录失败次数] → [超过阈值锁定] → [返回"密码错误"] → 结束
  ↓ 匹配
[重置失败次数]
  ↓
[生成JWT令牌]
  ↓
[记录登录日志]
  ↓
[返回令牌和用户信息]
  ↓
结束



3.7.2 权限验证流程图

开始
  ↓
[接收API请求]
  ↓
[解析JWT令牌] → 无效 → [返回401未授权] → 结束
  ↓ 有效
[验证令牌有效期] → 过期 → [返回403令牌过期] → 结束
  ↓ 有效
[提取用户权限信息]
  ↓
[比对请求所需权限] → 无权限 → [返回403禁止访问] → 结束
  ↓ 有权限
[允许访问资源]
  ↓
结束
